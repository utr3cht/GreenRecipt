{% extends 'accounts/base.html' %}
{% load static %}

{% block title %}新規登録 | GreenReceipt{% endblock %}

{% block content %}
<form method="post" action="{% url 'accounts:register' %}" class="full">
  {% csrf_token %}

  <div style="text-align:center;">
    <img src="{% static 'img/logo.png' %}" alt="GreenReceipt ロゴ" style="width:200px;margin-bottom:15px;">
  </div>

<style>
    .password-container {
      position: relative;
    }
    .password-container input {
      padding-right: 60px; /* Make space for the button */
    }
    .toggle-password {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      cursor: pointer;
      border: none;
      background: none;
      font-size: 0.8em; /* Slightly smaller font size */
      color: #007bff; /* A more prominent color */
      padding: 0 5px; /* Add some padding */
      z-index: 10; /* Ensure it's above the input */
    }
  </style>

  {% for field in form.visible_fields %}
    <div class="form-group">
      {{ field.label_tag }}
      {% if field.name == 'password1' or field.name == 'password2' %}
        <div class="password-container">
          {{ field }}
          <button type="button" class="toggle-password" onclick="togglePasswordVisibility(this, '{{ field.id_for_label }}')" title="パスワードの表示/非表示を切り替える">表示</button>
        </div>
      {% else %}
        {{ field }}
      {% endif %}
      {% if field.help_text %}
        <small class="form-text text-muted">{{ field.help_text }}</small>
      {% endif %}
      {% for error in field.errors %}
        <div class="alert alert-danger">{{ error }}</div>
      {% endfor %}
    </div>
  {% endfor %}

  <script>
    function togglePasswordVisibility(button, fieldId) {
      var passwordField = document.getElementById(fieldId);
      if (passwordField.type === "password") {
        passwordField.type = "text";
        button.textContent = "非表示";
      } else {
        passwordField.type = "password";
        button.textContent = "表示";
      }
    }
  </script>

  <div class="actions" style="text-align:center;">
    <button type="button" onclick="history.back()">戻る</button>
    <button type="submit">確認</button>
  </div>
</form>
{% endblock %}
