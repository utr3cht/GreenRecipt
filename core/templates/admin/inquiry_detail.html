{% extends 'core/base.html' %}

{% block title %}
  お問い合わせ詳細 | GreenReceipt
{% endblock %}

{% block content %}
  <main class="dashboard-main">
    <div class="dashboard-container inquiry-detail">
      <h1>お問い合わせ詳細</h1>

      <section class="inquiry-card">
        <header>
          <h2>{{ inquiry.subject }}</h2>
        </header>
        <div class="inquiry-meta">
          <p>
            <strong>ID:</strong> {{ inquiry.id }}
          </p>
          <p>
            <strong>ユーザー:</strong> {% if inquiry.user %}
              {{ inquiry.user.username }}
            {% else %}
              ゲスト
            {% endif %}
          </p>
          <p>
            <strong>返信先メールアドレス:</strong> {{ inquiry.reply_to_email }}
          </p>
          <p>
            <strong>作成日時:</strong> {{ inquiry.created_at|date:'Y年n月j日 H:i' }}
          </p>
        </div>

        <div class="inquiry-body">
          <h3>お問い合わせ内容</h3>
          <p>{{ inquiry.body_text|linebreaksbr }}</p>
          {% if inquiry.image %}
            <h3>添付画像</h3>
            <img src="{{ inquiry.image.url }}" alt="添付画像" class="inquiry-image" />
          {% endif %}
        </div>
      </section>

      <section class="inquiry-reply">
        {% if inquiry.is_replied %}
          <h2>返信済み</h2>
          <div class="inquiry-body">
            <h3>返信内容</h3>
            <p>{{ inquiry.reply_message|linebreaksbr }}</p>
          </div>
        {% else %}
          <h2>お問い合わせに返信する</h2>
          <form method="post" class="reply-form">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">返信する</button>
          </form>
        {% endif %}
        <a href="{% url 'core:admin_inquiry_dashboard' %}" class="btn btn-secondary">ダッシュボードに戻る</a>
      </section>
    </div>
  </main>
{% endblock %}
